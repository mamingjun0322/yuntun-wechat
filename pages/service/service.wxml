<!--pages/service/service.wxml-->
<view class="service-container">
  <!-- å¸¸è§é—®é¢˜ -->
  <view class="faq-section" wx:if="{{faqList.length}}">
    <view class="section-title">å¸¸è§é—®é¢˜</view>
    <view class="faq-list">
      <view 
        class="faq-item"
        wx:for="{{faqList}}"
        wx:key="id"
        bindtap="toggleFaq"
        data-index="{{index}}"
      >
        <view class="faq-question">
          <text class="question-icon">ğŸ’¬</text>
          <text class="question-text">{{item.question}}</text>
          <text class="toggle-icon">{{item.expanded ? 'â–²' : 'â–¼'}}</text>
        </view>
        <view class="faq-answer" wx:if="{{item.expanded}}">
          <text>{{item.answer}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <scroll-view 
    class="message-list" 
    scroll-y 
    scroll-into-view="{{scrollToView}}"
    scroll-with-animation
  >
    <view class="message-wrapper">
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{!messageList.length}}">
        <text class="empty-icon">ğŸ’¬</text>
        <text class="empty-text">æš‚æ— æ¶ˆæ¯è®°å½•</text>
        <text class="empty-hint">å‘é€æ¶ˆæ¯å¼€å§‹å’¨è¯¢</text>
      </view>

      <!-- æ¶ˆæ¯åˆ—è¡¨ -->
      <view 
        class="message-item {{item.type === 1 ? 'user-message' : 'service-message'}}"
        wx:for="{{messageList}}"
        wx:key="id"
        id="msg-{{item.id}}"
      >
        <view class="message-avatar">
          <text class="avatar-icon">{{item.type === 1 ? 'ğŸ‘¤' : 'ğŸ‘¨â€ğŸ’¼'}}</text>
        </view>
        <view class="message-content">
          <view class="message-info">
            <text class="message-name">{{item.type === 1 ? 'æˆ‘' : 'å®¢æœ'}}</text>
            <text class="message-time">{{item.createTime}}</text>
          </view>
          <view class="message-bubble">
            <text>{{item.content}}</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- è¾“å…¥æ¡† -->
  <view class="input-box">
    <view class="input-top">
      <text class="limit-tip">ä»Šæ—¥å‰©ä½™æ¬¡æ•°ï¼š{{config.remaining}}/{{config.dailyLimit}}</text>
    </view>
    <view class="input-bottom">
      <input 
        class="message-input"
        placeholder="è¯·è¾“å…¥æ‚¨è¦å’¨è¯¢çš„é—®é¢˜..."
        value="{{inputMessage}}"
        bindinput="inputMessage"
        confirm-type="send"
        bindconfirm="sendMessage"
      />
      <view 
        class="send-btn {{inputMessage ? 'active' : ''}}"
        bindtap="sendMessage"
      >
        å‘é€
      </view>
    </view>
  </view>
</view>
