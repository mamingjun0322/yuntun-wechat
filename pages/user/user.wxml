<!--pages/user/user.wxml-->
<view class="user-container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒº -->
  <view class="user-header gradient-bg">
    <block wx:if="{{userInfo}}">
      <view class="avatar-wrapper">
        <text class="default-avatar" wx:if="{{!userInfo.avatar}}">ğŸ‘¤</text>
        <image 
          wx:else
          class="user-avatar" 
          src="{{userInfo.avatar}}"
          mode="aspectFill"
        ></image>
      </view>
      <view class="user-info">
        <text class="user-name">{{userInfo.nickname || 'å¾®ä¿¡ç”¨æˆ·'}}</text>
        <view class="user-tags">
          <text class="tag" wx:if="{{userInfo.level > 0}}">Lv.{{userInfo.level}}</text>
          <text class="tag">ID: {{userInfo.id}}</text>
        </view>
      </view>
      <view class="edit-profile-btn" bindtap="editProfile" wx:if="{{!userInfo.nickname || !userInfo.avatar}}">
        <text>å®Œå–„èµ„æ–™</text>
      </view>
    </block>
    <block wx:else>
      <view class="avatar-wrapper">
        <text class="default-avatar">ğŸ‘¤</text>
      </view>
      <view class="user-info">
        <text class="user-name">æœªç™»å½•</text>
        <text class="login-tip" bindtap="goLogin">ç‚¹å‡»ç™»å½•äº«æ›´å¤šæœåŠ¡ â€º</text>
      </view>
    </block>
  </view>

  <!-- ç§¯åˆ†å’Œä¼˜æƒ åˆ¸ -->
  <view class="stats-card card" wx:if="{{userInfo}}">
    <view class="stat-item" bindtap="goPoints">
      <text class="stat-value">{{userInfo.points || 0}}</text>
      <text class="stat-label">ç§¯åˆ†</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item" bindtap="goCoupons">
      <text class="stat-value">{{userInfo.couponCount || 0}}</text>
      <text class="stat-label">ä¼˜æƒ åˆ¸</text>
    </view>
  </view>

  <!-- æˆ‘çš„è®¢å• -->
  <view class="order-card card" wx:if="{{userInfo}}">
    <view class="card-header">
      <text class="card-title">æˆ‘çš„è®¢å•</text>
      <view class="view-all" bindtap="goOrderList" data-status="0">
        <text>æŸ¥çœ‹å…¨éƒ¨</text>
        <text class="arrow">â€º</text>
      </view>
    </view>
    <view class="order-tabs">
      <view class="order-tab" bindtap="goOrderList" data-status="1">
        <view class="tab-icon-wrapper">
          <text class="tab-icon">â°</text>
          <view class="order-badge" wx:if="{{orderStats.pending > 0}}">{{orderStats.pending}}</view>
        </view>
        <text class="tab-name">å¾…æ”¯ä»˜</text>
      </view>
      <view class="order-tab" bindtap="goOrderList" data-status="2">
        <view class="tab-icon-wrapper">
          <text class="tab-icon">ğŸ‘¨â€ğŸ³</text>
          <view class="order-badge" wx:if="{{orderStats.processing > 0}}">{{orderStats.processing}}</view>
        </view>
        <text class="tab-name">åˆ¶ä½œä¸­</text>
      </view>
      <view class="order-tab" bindtap="goOrderList" data-status="3">
        <view class="tab-icon-wrapper">
          <text class="tab-icon">ğŸšš</text>
          <view class="order-badge" wx:if="{{orderStats.delivering > 0}}">{{orderStats.delivering}}</view>
        </view>
        <text class="tab-name">é…é€ä¸­</text>
      </view>
      <view class="order-tab" bindtap="goOrderList" data-status="4">
        <text class="tab-icon">âœ…</text>
        <text class="tab-name">å·²å®Œæˆ</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card card" wx:if="{{userInfo}}">
    <view 
      class="menu-item"
      wx:for="{{menuList}}"
      wx:key="name"
      bindtap="goMenuPage"
      data-index="{{index}}"
    >
      <view class="menu-left">
        <text class="menu-icon">{{item.icon}}</text>
        <text class="menu-name">{{item.name}}</text>
      </view>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-btn" wx:if="{{userInfo}}" bindtap="logout">
    é€€å‡ºç™»å½•
  </view>

  <!-- æœªç™»å½•æç¤º -->
  <view class="login-card card" wx:else>
    <text class="login-text">ç™»å½•åå¯æŸ¥çœ‹æ›´å¤šåŠŸèƒ½</text>
    <view class="login-button" bindtap="goLogin">ç«‹å³ç™»å½•</view>
  </view>
</view>
